# 问题描述

## 经纪人DongZhen与uzdz艺人演出代理项目

> 艺人uzdz平时工作很忙，当其他商务公司找uzdz做项目时，如果全有uzdz来提供服务，可能存在问题，比如合同是否合法、uzdz是否能够应付的过来等状况。

> 这时候就需要聘请一个代理人也就是经纪人DongZhen来减轻uzdz的压力，以及对uzdz进行一些规划。

> 考虑到当处于抽奖中状态时就不能投币等特殊情况，也就是说不同的状态，能做的事情不同。活动大概有下面三种状态：

1. 等待扣除积分状态：扣除积分后才能进行抽奖
2. 抽奖中状态：抽中则进行奖品发放，否则状态变更为等待扣除积分
3. 发放奖品中状态：表示抽中了，但是还要检查是否还有库存，如果有则正常颁发奖品，否则颁发失败并置为等待扣除积分状态

## 代理模式（Proxy Pattern）

### 模式概述

> 代理模式为另一个对象提供一个替身以控制对这个对象的访问。其实就是代理就是做到类似转发的功能，针对不同代理，转发的具体实现不同。代理模式主要是为了增强被代理类的权限控制。

> 比如猪八戒去找高翠兰结果是孙悟空变的，可以这样理解：把高翠兰的外貌抽象出来，高翠兰本人和孙悟空都实现了这个接口，猪八戒访问高翠兰的时候看不出来这个是孙悟空，所以说孙悟空是高翠兰代理类。

### 优点
1. 职责清晰，被代理对象只负责自己实际的业务逻辑，不关心其他非本身的职责。并将其他事务可以通过代理类处理。
2. 高扩展性，无论被代理对象如何改变，只要代理类和被代理类都实现了统一接口，都不同修改代理类，而且即使扩展了新的被代理类，代理类也可以使用，只要创建代理类的时候传入对应的被代理类对象。

### 缺点
1. 如果不合理的使用代理模式，可能会导致请求处理速度变慢，降低并发量。实现代理模式需要额外的工作，这会导致资源的消耗，如果复杂的代理模式可能会降低系统性能。
2. 实现代理模式需要额外的工作，有些代理模式的实现非常复杂。

## 注意事项
1. 从代理的种类中可以进一步看清代理模式的使用场景，无非就是转发远程请求、作为创建开销大对象的替身、在本地保存网络资源、控制一些受保护资源的权限访问、作负载均衡。
2. 代理模式是通过引入中间层来解决直接访问对象时带来的问题。

## 代理模式与适配器、装饰者模式的区别？
* 代理模式：不修改被代理类的实现，且通过代理类增强被代理类的权限控制
* 适配器模式的区别：适配器模式主要改变所考虑对象的接口，而代理模式不能改变所代理类的接口。
* 装饰器模式的区别：装饰器模式为了增强功能，而代理模式是为了加以控制。

## 常见代理模式
1. 虚拟代理：可以作为创建开销大的对象的代表，虚拟代理让我们真正需要使用一个对象时才会去创建这个对象。在对象创建前和创建中，虚拟代理扮演真实对象的替身，当对象创建完毕后，虚拟代理会把请求直接委托给真实对象。虚拟代理在手机页面加载中经常可以见到，比如打开页面显示"**正在玩命加载中..."。
2. 缓存代理：可以理解成把网络上的静态资源或者不常改变的数据保存在本地，再次访问的这次数据的时候直接从本地读取。应用例子有页面的缓存机制、cdn、app缓存机制等。
3. 保护代理：根据角色或者其他机制控制用户对一些资源的访问权限。这常见于一些网站需要登录才能获取更多的内容，struts2和spring的拦截器等。
4. 静态代理：可以理解为对象由代理创建，在创建前后做一些事情，比如统计创建了多少对象，但静态代理只能创建一个或固定的几个对象。详见：http://blog.csdn.net/lidatgb/article/details/8941711。
5. 动态代理：其用途跟静态代理类型，但可以利用反射机制动态地创建对象，可以减少代理代码的重复，有更好的扩展性。详见：http://blog.csdn.net/lidatgb/article/details/8993131。
6. 正向代理：用户可以指定代理服务器转发请求到目标服务器完成，用户知道代理服务器地址和目标服务器地址。常见于FQ代理服务器。
7. 反向代理： 用户访问的目标服务器其实是代理服务器，代理服务器做负载均衡后把请求转发到真正的目标服务器执行。常见于负载均衡服务器。