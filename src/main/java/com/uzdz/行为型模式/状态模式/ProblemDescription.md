# 问题描述

## APP抽奖项目

> 每参加一次这个活动要扣除用户50积分，中奖概率是10%，奖品数量固定，抽完就不能抽奖了。

> 考虑到当处于抽奖中状态时就不能投币等特殊情况，也就是说不同的状态，能做的事情不同。活动大概有下面三种状态：

1. 等待扣除积分状态：扣除积分后才能进行抽奖
2. 抽奖中状态：抽中则进行奖品发放，否则状态变更为等待扣除积分
3. 发放奖品中状态：表示抽中了，但是还要检查是否还有库存，如果有则正常颁发奖品，否则颁发失败并置为等待扣除积分状态

## 状态模式（State Pattern）

### 模式概述

> 状态模式中类的行为是基于它的状态改变的，允许对象在内部状态改变时改变它的行为，对象看起来好像修改了它自己的类

> 对象的行为依赖于它的状态（属性），并且可以根据它的状态改变而改变它的相关行为。

### 优点
1. 代码有很强的可读性。状态模式将每个状态的行为封装到对应的一个类中。
2. 枚举可能的状态，在枚举状态之前需要确定状态种类。
3. 将所有与某个状态有关的行为放到一个类中，并且可以方便地增加新的状态，只需要改变对象状态即可改变对象的行为。

### 缺点
1. 状态模式的使用必然会增加系统类和对象的个数，当状态过多时会产生很多类，加大维护难度。
2. 状态模式的结构与实现都较为复杂，如果使用不当将导致程序结构和代码的混乱。

## 注意事项
1. 在行为受状态约束的时候使用状态模式。
2. 主要用来解决对象在多种状态转换时，需要对外输出不同的行为的问题。状态和行为是一一对应的，状态之间可以相互转换。

## 状态模式与策略模式对比

#### 行为是否固定
* 状态模式：在不同的状态，其相同方法具有不同的行为。
* 策略模式：选择了一个策略后，其方法也是固定的。

#### 客户是否需要了解代码细节
* 状态模式中，客户不用管context对象的状态时如何运作的，只要调用其提供的方法就好了。
* 策略模式中，客户调用context对象时，需要了解有哪些策略，最后选出一种策略。

#### 使用场景
* 状态模式：当一个事件或者对象有很多种状态，状态之间会相互转换，对不同的状态要求有不同的行为的时候使用。
* 策略模式：作为继承的一种替代方案，客户端可以动态选择哪一种行为，而如果没有用策略，客户端每当需要一种新的行为时就要创建一个子类重写父类方法，这相当被动。